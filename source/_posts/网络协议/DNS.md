---
title: DNS解析过程
date: 2021-08-21 19:43:39
tags:
- 计算机网络
- 应用层
- DNS
categories:
- 计算机网络
- 应用层
- DNS

---

<center>
引言：DNS解析过程；更新：补充了DNS的一个搜索环节
</center>




<!-- more -->



# DNS解析过程

## 前置概念

> 1、 什么是DNS？

DNS，全称为Domain Name Server，作用就是**将域名解析为IP地址**

默认端口号为53

> 2、 域名服务器都有哪些？

- 本地域名服务器：当地的域名服务器，比如说一个大学就有一个域名服务器
- 根域名服务器：**最高层次的域名服务器**，可以知道所有的顶级域名服务器的域名和IP地址
- 顶级域名服务器：管理在该顶级域名下的所有二级域名
- 权限域名服务器：负责管理一个区（区的范围小于等于域，是DNS服务器的管理单位）

## 一个域名的解析之路

> 当我们输入一个网址，比如`www.yesmylord.cn`（我的博客），DNS都做了什么？

1. 你在浏览器地址栏输入了`www.yesmylord.cn`
2. 查询**浏览器缓存**（浏览器缓存会缓存最近浏览过的网页的域名与IP地址；缓存的时间是由OS定的，而不是浏览器）
3. 如果没有，查询**系统缓存**，向OS发起一个系统调用，查询系统缓存
4. 如果没有，查询本机的域名解析文件`hosts`
5. 如果没有，去**路由器缓存**查找
6. 如果没有，去**本地DNS服务器**查缓存
7. 如果没有，就开始了一个大的过程（**迭代查询**）：
   1. 本地DNS服务器会代替我们，向根域名服务器发送请求（这里叫**递归查询**：因为DNS是代替我们进行的查询，而不是我们主机发起的查询）
   2. 根域名服务器告诉我们去哪个顶级域名服务器查找（解析出`.cn`）
   3. 顶级域名服务器告诉我们权限域名服务器位置（解析`.yesmylord`）
   4. 权限域名服务器返回真正的IP地址（解析出`www`）

至此浏览器就知道了要发送目的地的IP了

> 值得注意的是，DNS查到的可能是CDN服务器的地址

CDN服务器可以**缓存一个网站的静态资源**，**达到快速响应的目的**

注意：

- 缓存的是**静态资源**，动态资源不能缓存

## 总结

查询过程：

1. 浏览器缓存
2. 系统缓存
3. hosts文件
4. 路由器缓存
5. 本地DNS服务器缓存
6. 根域名服务器
7. 顶级域名服务器
8. 权限域名服务器（有的也叫权威域名服务器）